<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ตารางแสดงภาระหนี้</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="">
        <label for="disbdate">disbdate</label>
        <input type="date" id="disbdate" value="2023-12-24" onchange="updateTable()">
    </div>
    <div class="">
        <label for="firstpaymentdate">firstpaymentdate</label>
        <input type="date" id="firstpaymentdate" value="2023-12-20" onchange="updateTable()">
        </div>
    <div class="">
        <span class="err" id="firstpaymentdateerr"></span>
        </div>
    <div class="">
        <label for="dueday">dueday</label>
        <input type="number" id="dueday" value="25" max="31" onchange="updateTable()">
    </div>
    <div class="">
        <label for="termyear">termyear</label>
        <input type="number" id="termyear" value="30" onchange="updateTable()">
    </div>
    <div class="">
        <label for="principal">principal</label>
        <input type="number" id="principal" value="40000" onchange="updateTable()">
    </div>
    <div class="">
        <span class="err" id="principalerr"></span>
    </div>
    <div class="">
        <label for="installment">installment</label>
        <input type="text" id="installment" value="1211,1186" onchange="updateTable()">
    </div>
    <div class="">
        <label for="intrates">intrates</label>
        <input type="text" id="intrates" value="0.05625,0.03625" onchange="updateTable()">
    </div>
    <div class="">
        <label for="tos">tos</label>
        <input type="text" id="tos" value="12,36" onchange="updateTable()">
    </div>
    <div class="">
        <span class="err" id="tiererr"></span>
    </div>
    <div class="">
        <span class="err" id="termerr"></span>
    </div>
    <table border="1">
        <thead>
            <th>งวดที่</th>
            <th>วันที่ชำระ</th>
            <th>จำนวนเงินชำระ</th>
            <th>การนําเงินค่างวดกู้ยืมไปชําระเงินต้น</th>
            <th>การนําเงินค่างวดกู้ยืมไปชําระดอกเบี้ย</th>
            <th>เงินต้นคงค้าง</th>
        </thead>
        <tbody>

        </tbody>
    </table>
    <div id="curve_chart" style="width: 900px; height: 500px"></div>
    <script src="npm.js"></script>
    <script src="format.js"></script>
    <script defer src="app.js"></script>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script defer>
        google.charts.load('current', { 'packages': ['corechart'] });

        function drawChart() {
            const chartArr = []
            const showRemainingPrincipal = false
            if (showRemainingPrincipal) {
                for (let row of rows) {
                    chartArr.push(
                        [
                            row.countInstallment
                            , row.RemainingPrincipal
                            
                        ]
                    )
                }
            } else {
                for (let row of rows) {
                    chartArr.push(
                        [
                            row.countInstallment
                            , row.InterestDueAmount
                            , row.DeductPrincipal
                            , row.PaymentAmount
                        ]
                    )
                }
            }
            console.log(chartArr)
            var data = google.visualization.arrayToDataTable([
                showRemainingPrincipal ? ['InstallmentNo', 'RemainingPrincipal'] : ['InstallmentNo', 'paidInterest', 'decuctPrinciple','PaymentAmount']
                ,
                ...chartArr
            ]);

            var options = {
                title: '',
                curveType: 'function',
                legend: { position: 'bottom' }
            };

            var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

            chart.draw(data, options);
        }
    </script>
</body>

</html>